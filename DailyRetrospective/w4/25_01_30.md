# ë°ì¼ë¦¬ ë¦¬ë·°

ë‚ ì§œ: 2025ë…„ 1ì›” 30ì¼
ì‘ì„±ì: ìµœë¯¼ì œ

# âœï¸Â Review

## pyspark.sql ê´€ë ¨ í•¨ìˆ˜

- [`agg()`](https://spark.apache.org/docs/latest/api/python/reference/pyspark.sql/api/pyspark.sql.DataFrame.agg.html#pyspark.sql.DataFrame.agg)
    
    ```python
      nyc_taxi_hourly_summary = nyc_taxi_hourly_df.groupBy(
          'pickup_date_hour'
      ).agg(
          count(col('tpep_pickup_datetime')).alias('trip_count'),
          avg(col('trip_distance')).alias('avg_trip_distance'),
          avg(col('total_amount')).alias('avg_total_amount'),
          avg(col('trip_min')).alias('avg_trip_min')
      )
    ```
    
    ìœ„ ì½”ë“œëŠ”, í•˜ë‚˜ì˜ column ê°’ì„ ê¸°ë°˜ìœ¼ë¡œ groupbyë¥¼ í•œ ì´í›„ì—, ê° group ë³„, í‰ê· ê°’ì´ë‚˜, row ê°œìˆ˜ë¥¼ êµ¬í•˜ê²Œ ëœë‹¤.
    
- zscoreë¥¼ í†µí•œ í•„í„°ë§
    
    ```python
    # ì´ìƒì¹˜ë¥¼ ì œê±°í•˜ëŠ” í•¨ìˆ˜. í‘œì¤€ì ìˆ˜ê°€ 3.5ì´ìƒ ë„˜ì–´ê°€ë©´ í•„í„°ë§ëœë‹¤.
    def remove_outliers_zscore(df, columns, threshold=3.5):
        stats = df.select(
            *[mean(col(c)).alias(f"{c}_mean") for c in columns],
            *[stddev(col(c)).alias(f"{c}_stddev") for c in columns]
        ).collect()[0]
    
        for c in columns:
            mean_val = stats[f"{c}_mean"]
            stddev_val = stats[f"{c}_stddev"]
            df = df.filter(((col(c) - mean_val) / stddev_val).between(-threshold, threshold))
    
        return df
    ```
    
    df.select() ë‚´ë¶€ì—ì„œ columnìœ¼ë¡œ ì£¼ì–´ì§„ ê°’ë“¤ì— ëŒ€í•´ì„œ ê°ê°ì˜ meanê³¼ stddevë¥¼ êµ¬í•œë‹¤.
    
    z-scoreë¥¼ í†µí•´ì„œ ë°ì´í„°ê°€ í‰ê· ì—ì„œ 3.5ì´ìƒ ë„˜ì–´ê°€ê²Œ ë˜ë©´, ê°’ì„ ì œê±°í•˜ë„ë¡ í•˜ì˜€ë‹¤.
    

## íŒ€ í”„ë¡œì íŠ¸ ê´€ë ¨

- ì›¹íˆ° ë°ì´í„°ë¥¼ í¬ë¡¤ë§ í•œ ì´í›„ì—, í”¼ë“œë°±ì„ í†µí•œ ê°œì„ ì„ ìœ„í•´ì„œ ë…ìë“¤ì˜ ëŒ“ê¸€ì´ ê¸ì •ì ì´ ë°˜ì‘ì„ ê°€ì¡ŒëŠ”ì§€ ë¶€ì •ì ì¸ ë°˜ì‘ì„ ê°€ì¡ŒëŠ”ì§€ í™•ì¸í•  í•„ìš”ê°€ ìˆì—ˆë‹¤. ì´ë¥¼ ìœ„í•´, ê°ì„±ë¶„ì„ì— ì í•©í•œ ëª¨ë¸ì„ ì°¾ì•„ë³´ì•˜ê³ , ê²°ê³¼ì ìœ¼ë¡œ koelectraë¥¼ ì‡¼í•‘ëª° ë¦¬ë·°ë¥¼ í†µí•´ ì¶”ê°€ íŒŒì¸íŠœë‹í•œ ëª¨ë¸ì„ í™œìš©í•˜ì˜€ë‹¤.
    
    ì´í›„ì—ëŠ” ë°ì´í„°ë¥¼ ëª¨ì•„ì„œ ì§ì ‘ ë¼ë²¨ë§ì„ í•œë‹¤ë©´ ì¢€ ë” ì¢‹ì€ ì„±ëŠ¥ì„ ë‚¼ ìˆ˜ ìˆì„ ê²ƒì´ë¼ê³  ìƒê°í•˜ë©°, í˜„ì¬ ë¯¸ë‹ˆ í”„ë¡œì íŠ¸ì—ì„œì˜ ì‹¤í˜„ ê°€ëŠ¥ì„±ì„ íŒŒì•…í•  ìˆ˜ ìˆëŠ” ì •ë„ë¡œì˜ ëª¨ë¸ë¡œëŠ” ì í•©í•˜ë‹¤ê³  íŒë‹¨í•˜ì—¬ í•´ë‹¹ ëª¨ë¸ì„ ì‚¬ìš©í•˜ì˜€ë‹¤.
    

# ğŸ¤”Â Retrospective

## âš ï¸Â Problem

- ì¶œë ¥ ì €ì¥ í˜•ì‹ì„ ì¢€ ë” ê°œì„  í•  ìˆ˜ ìˆëŠ” ë¶€ë¶„ì„ ì¼ë‹¨ íŒŒì•…í•˜ì˜€ì§€ë§Œ, ë„˜ì–´ê°”ë‹¤.
    - csvê°€ parquetì— ë¹„í•´ì„œ File I/O ë¶€ë¶„ì—ì„œ ë¹„íš¨ìœ¨ì ì´ë¼ëŠ” ê²ƒì„ í™•ì¸í•˜ì˜€ì§€ë§Œ, ì‹œê°„ì´ ë¶€ì¡±í•˜ë‹¤ëŠ” ì´ìœ ë¡œ ê°œì„ í•˜ì§€ ëª»í–ˆë‹¤.

## ğŸŒŸÂ Keep

## ğŸ’¡Â Try